<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>Ampel-Prototyp ‚Äì Ausgangstext & √úbersetzung</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding: 16px; line-height: 1.6; }
  h3, h4 { margin: 0.5rem 0; }
  .section { margin-bottom: 16px; }

  /* Zwei Fenster nebeneinander */
  .side-by-side { display: flex; gap: 16px; max-width: 100%; }
  .editable {
    flex: 1; border: 2px solid #ccc; border-radius: 8px; padding: 1rem;
    min-height: 320px; overflow-y: auto; background: #fafafa;
  }
  .editable:focus { outline: none; border-color: #228b22; background: #fff; }

  /* Ampel-Badges */
  .ampel-badges { margin-bottom: 8px; }
  .badge {
    border: none; color: white; padding: 0.5rem 1rem; margin: 0.25rem;
    border-radius: 6px; cursor: pointer; font-weight: 600;
  }
  .badge.gruen { background: #228b22; }
  .badge.gelb  { background: #ffd700; }
  .badge.rot   { background: #c62828; }

  /* Overlays */
  .overlay-box {
    background: #f9f9f9; border-left: 6px solid; padding: 1rem; border-radius: 8px;
    max-width: 720px; margin: 0.75rem 0;
  }
  #overlay-gruen { border-color: #228b22; }
  #overlay-gelb  { border-color: #ffd700; }
  #overlay-rot   { border-color: #c62828; }
  .hidden { display: none; }

  /* Segment-Markierungen */
  .mark { cursor: pointer; border-radius: 3px; padding: 0 2px; }
  .mark.gruen { background-color: #e6ffe6; border-bottom: 2px solid #228b22; }
  .mark.gelb  { background-color: #ffffe0; border-bottom: 2px dashed #ffd700; }
  .mark.rot   { background-color: #ffe6e6; border-bottom: 2px dashed #c62828; }

  /* Gesamteinsch√§tzung (inline hinter √úberschrift) */
  .overall-badge {
    margin-left: 12px; padding: 0.2rem 0.6rem; font-weight: 600; border-radius: 6px; display: inline-block;
  }
  .overall-badge.gruen { background: #228b22; color: white; }
  .overall-badge.gelb  { background: #ffd700; color: black; }
  .overall-badge.rot   { background: #c62828; color: white; }

  /* Hilfe-Box */
  .help-box {
    position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
    background: #fff; border: 2px solid #ccc; padding: 1rem; border-radius: 12px;
    max-width: 640px; box-shadow: 0 8px 24px rgba(0,0,0,0.18); z-index: 1000;
  }
  .help-box-header { display:flex; justify-content:space-between; align-items:center; }
  .help-box .close { cursor: pointer; font-size: 20px; font-weight: bold; line-height: 1; }
  .help-box button {
    margin-top: 0.5rem; padding: 0.4rem 0.8rem; border: none; border-radius: 4px; background: #eee; cursor: pointer;
  }
  .help-box button:hover { background: #ddd; }
</style>
</head>
<body>

<!-- Ampelsteuerung und Overlays -->
<div class="section">
  <div class="ampel-badges">
    <button class="badge gruen" onclick="openOverlay('gruen')">üü¢ Sicher</button>
    <button class="badge gelb" onclick="openOverlay('gelb')">üü° Unsicher</button>
    <button class="badge rot" onclick="openOverlay('rot')">üî¥ Riskant</button>
  </div>

  <div id="overlay-gruen" class="overlay-box hidden">
    <h3>üü¢ √úbersetzung ‚Äì Verl√§sslich</h3>
    <p>√úbersetzung ist verl√§sslich. Sie k√∂nnen den Text direkt verwenden.</p>
  </div>

  <div id="overlay-gelb" class="overlay-box hidden">
    <h3>üü° √úbersetzung ‚Äì Verbesserungsbed√ºrftig</h3>
    <p>√úbersetzung ist verst√§ndlich, aber nicht perfekt. Mit Vorsicht verwenden ‚Äì bei wichtigen Inhalten professionelle Hilfe empfohlen.</p>
  </div>

  <div id="overlay-rot" class="overlay-box hidden">
    <h3>üî¥ √úbersetzung ‚Äì Nicht vertrauensw√ºrdig</h3>
    <p><strong>Qualit√§tseinsch√§tzung:</strong> Niedrig</p>
    <p><strong>Risiko:</strong> Hoch (falsche Bedeutungen, unprofessionelle Tonalit√§t)</p>
    <p><strong>Empfehlung f√ºr Laien:</strong> F√ºr wichtige Inhalte bitte nicht verwenden; f√ºr grobe Orientierung nur mit Vorsicht.</p>
  </div>
</div>

<!-- Zwei Fenster nebeneinander -->
<div class="side-by-side">
  <div id="source-pane" class="editable" contenteditable="true">
    <h4>Ausgangstext</h4>
    ‚ÄûDas ist ja ein dicker Hund!‚Äú rief der Manager nach der Pr√§sentation. ‚ÄûWir m√ºssen das unbedingt bis zum n√§chsten Meeting auf die Reihe kriegen, sonst geht uns der Saft aus. Ich brauche eure Inputs bis Freitag ‚Äì macht doch einfach einen F√ºnfer gerade sein.‚Äú<br><br>
    Unser neues Produkt ist eigentlich eine eierlegende Wollmilchsau, aber das Marketing hat es total versalzen. Jetzt sitzen wir auf dem Trockenen und der Chef ist stocksauer. Wir sollten nicht aus der Haut fahren, sondern die Kirche im Dorf lassen.<br><br>
    Ach ja, und denkt an den Datenschutz ‚Äì das ist doch Ehrensache! Wir wollen ja nicht in die Bredouille kommen wie die Kollegen aus dem letzten Quartal. Die haben n√§mlich den Rubel rollen lassen, ohne an die Rechtslage zu denken.
  </div>

  <div id="target-pane" class="editable" contenteditable="true">
    <h4>Zieltext 
      <span id="overall-score" class="overall-badge">Gesamteinsch√§tzung: üî¥ Rot</span>
    </h4>
    "<span class="mark rot" data-key="hund">That's a big dog!</span>" shouted the manager after the presentation.
    "We absolutely have to get this done by the next meeting, otherwise <span class="mark rot" data-key="juice">we'll run out of juice</span>.
    I need your <span class="mark rot" data-key="inputs">inputs</span> by Friday ‚Äì <span class="mark rot" data-key="fiver">just make a fiver straight</span>."
    Our new product is actually a <span class="mark gelb" data-key="jack">jack-of-all-trades</span>, but marketing has totally <span class="mark gelb" data-key="spoiled">spoiled it</span>.
    Now we're <span class="mark rot" data-key="dry">sitting on dry land</span> and the boss is.
    We should not <span class="mark rot" data-key="skin">get out of our skin</span>, but <span class="mark rot" data-key="church">leave the church in the village</span>.
    Oh yes, and think about <span class="mark gruen" data-key="dataprotection">data protection</span> ‚Äì that's <span class="mark gruen" data-key="honor">a matter of honor</span>!
    We don't want to <span class="mark gelb" data-key="predicament">get into a predicament</span> like our colleagues from last quarter.
    They <span class="mark rot" data-key="ruble">let the ruble roll</span> without thinking about the legal situation.
  </div>
</div>

<!-- Hilfe-Box -->
<div id="help-box" class="help-box hidden">
  <div class="help-box-header">
    <h4 id="help-title"></h4>
    <span class="close" onclick="closeHelp()">√ó</span>
  </div>
  <p id="help-problem"></p>
  <div id="help-suggestions"></div>
</div>

<script>
/* Overlays steuern */
function openOverlay(level) {
  document.querySelectorAll('.overlay-box').forEach(o => o.classList.add('hidden'));
  const el = document.getElementById('overlay-' + level);
  if (el) el.classList.remove('hidden');
}

document.addEventListener('DOMContentLoaded', () => {
  /* R√ºck√ºbersetzungen */
  const backTranslations = {
    hund: "Das ist ja ein dicker Hund!",
    juice: "‚Ä¶ sonst geht uns der Saft aus.",
    inputs: "Inputs",
    fiver: "macht doch einfach einen F√ºnfer gerade sein.",
    jack: "eierlegende Wollmilchsau",
    spoiled: "versalzen",
    dry: "auf dem Trockenen sitzen",
    skin: "aus der Haut fahren",
    church: "die Kirche im Dorf lassen",
    dataprotection: "Datenschutz",
    honor: "Ehrensache",
    predicament: "in die Bredouille kommen",
    ruble: "den Rubel rollen lassen"
  };

  /* Vorschl√§ge f√ºr bessere √úbersetzungen */
  const suggestions = {
    hund: "That's outrageous!",
    juice: "otherwise we'll run out of steam",
    inputs: "feedback",
    fiver: "just let it slide",
    jack: "all-rounder",
    spoiled: "messed it up",
    dry: "left high and dry",
    skin: "lose our temper",
    church: "keep things in perspective",
    dataprotection: "data protection",
    honor: "matter of principle",
    predicament: "get into trouble",
    ruble: "splashed the cash"
  };

  /* Hilfe-Box Referenzen */
  const helpBox = document.getElementById('help-box');
  const helpTitle = document.getElementById('help-title');
  const helpProblem = document.getElementById('help-problem');
  const helpSuggestions = document.getElementById('help-suggestions');
  const targetPane = document.getElementById('target-pane');

  /* Button-Hilfsfunktion */
  function addSuggestionButton(mark, suggestion) {
    const btn = document.createElement('button');
    btn.textContent = "‚úÖ Vorschlag √ºbernehmen";
    btn.addEventListener('click', () => {
      mark.textContent = suggestion;
      mark.classList.remove('rot','gelb');
      mark.classList.add('gruen');
      calculateOverallScore();
      closeHelp();
    });
    helpSuggestions.appendChild(btn);
  }

  /* Gesamteinsch√§tzung berechnen */
  function calculateOverallScore() {
    const marks = document.querySelectorAll('#target-pane .mark');
    let score = 0, total = 0;
    marks.forEach(m => {
      total++;
      if (m.classList.contains('gelb')) score += 1;
      if (m.classList.contains('rot')) score += 3;
    });
    const badge = document.getElementById('overall-score');
    badge.classList.remove('gruen','gelb','rot');
    if (score === 0) {
      badge.textContent = "Gesamteinsch√§tzung: üü¢ Sicher";
      badge.classList.add('gruen');
      openOverlay('gruen');
    } else if (score <= Math.max(2, Math.round(0.25 * total))) {
      badge.textContent = "Gesamteinsch√§tzung: üü° Unsicher";
      badge.classList.add('gelb');
      openOverlay('gelb');
    } else {
      badge.textContent = "Gesamteinsch√§tzung: üî¥ Riskant";
      badge.classList.add('rot');
      openOverlay('rot');
    }
  }

  /* Initiale Berechnung */
  calculateOverallScore();

  /* Event-Delegation f√ºr Klicks auf markierte Segmente */
  targetPane.addEventListener('click', (evt) => {
    const mark = evt.target.closest('.mark');
    if (!mark) return;

    const key = mark.dataset.key;
    const back = backTranslations[key] || "(keine R√ºck√ºbersetzung verf√ºgbar)";
    const suggestion = suggestions[key] || "(kein Vorschlag verf√ºgbar)";

    helpTitle.textContent = "Stelle: " + mark.textContent.trim();
    helpSuggestions.innerHTML = ""; // reset
    helpProblem.textContent = "";   // reset

    // Inhalte abh√§ngig von der Ampel-Farbe
    if (mark.classList.contains('gruen')) {
      helpProblem.textContent = "üü¢ Keine Probleme erkannt ‚Äì direkt verwendbar.";
      helpSuggestions.innerHTML = `<div><strong>R√ºck√ºbersetzung:</strong> ${back}</div>`;
    } else if (mark.classList.contains('gelb')) {
      helpProblem.textContent = "üü° Problem: Idiomatik/Stil ‚Äì Nuance nicht vollst√§ndig getroffen.";
      helpSuggestions.innerHTML = `
        <div><strong>R√ºck√ºbersetzung:</strong> ${back}</div>
        <div><strong>Vorschlag:</strong> ${suggestion}</div>
      `;
      addSuggestionButton(mark, suggestion);
    } else if (mark.classList.contains('rot')) {
      helpProblem.textContent = "üî¥ Problem: Fehl√ºbertragung/Kalk ‚Äì nicht vertrauensw√ºrdig.";
      helpSuggestions.innerHTML = `
        <div><strong>R√ºck√ºbersetzung:</strong> ${back}</div>
        <div><strong>Vorschlag:</strong> ${suggestion}</div>
        <div style="margin-top:8px;">‚ö†Ô∏è Empfehlung: Nur f√ºr grobe Orientierung nutzbar; f√ºr wichtige Inhalte professionelle Hilfe.</div>
      `;
      addSuggestionButton(mark, suggestion);
    } else {
      helpProblem.textContent = "‚ÑπÔ∏è Unklassifiziertes Segment.";
      helpSuggestions.innerHTML = `<div><strong>R√ºck√ºbersetzung:</strong> ${back}</div>`;
    }

    // Box sichtbar machen
    helpBox.classList.remove('hidden');
  });

  /* Hilfe-Box schlie√üen (f√ºr das √ó) */
  window.closeHelp = () => helpBox.classList.add('hidden');

  /* Neu berechnen, wenn Zieltext editiert wird */
  targetPane.addEventListener('input', () => {
    calculateOverallScore();
  });
});
</script>
</body>
</html>